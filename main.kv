#:import hex kivy.utils.get_color_from_hex

<ThisScreenLabel@Label>:
    font_size: "30sp"
    background_color: hex('#666666')
    color: hex('#FFFFFF')
    size: 400, 75
    size_hint: None, None
    pos: 2, 1000
    canvas.before:
        Color:
            rgba: hex('#000000')
        Rectangle:
            pos: self.pos
            size: self.size

<NextScreenButton@Button>:
    font_size: "15sp"
    background_color: hex('#666666')
    color: hex('#FFFFFF')
    size: 400, 75
    size_hint: None, None
    pos: 2, 925

<TouchscreenCircle@Image>:
    size_hint: None, None
    allow_stretch: True
    keep_ratio: False

<LightdreamTouchScreen>:
    name: "lightdream"
    canvas.before:
        Color:
            rgba: hex('#000000')
        Rectangle:
            pos: self.pos
            size: self.size
    TouchscreenCircle:
        id: HUESHIFT
        size: 440, 440
    TouchscreenCircle:
        id: KALEIDOSCOPE
        size: 440, 440
    TouchscreenCircle:
        id: TUNNEL
        size: 440, 440
    TouchscreenCircle:
        id: LIGHTNING
        size: 160, 160
    TouchscreenCircle:
        id: NUCLEAR
        size: 160, 160
    TouchscreenCircle:
        id: SPIRAL
        size: 160, 160
    TouchscreenCircle:
        id: RADIANTLINES
        size: 160, 160
    TouchscreenCircle:
        id: RINGS
        size: 440, 440
    TouchscreenCircle:
        id: SPOTLIGHT
        size: 440, 440
    TouchscreenCircle:
        id: WEDGES
        size: 440, 440
    TouchscreenCircle:
        id: TRIFORCE
        size: 160, 160
    TouchscreenCircle:
        id: BLOBS
        size: 160, 160
    ThisScreenLabel:
        text: 'Lightdream'
    NextScreenButton:
        id: NEXT_SCREEN_BUTTON
        text: 'Next (Debug)'

<DebugMenuScreen>:
    name: 'debug_menu'

    BoxLayout:
        orientation: 'vertical'
        BoxLayout:
            id: top_bar
            size_hint: 1, 0.2
            padding: 10
            spacing: 10
            BoxLayout:
                orientation: 'vertical'
                padding: 10
                spacing: 10
                ThisScreenLabel:
                    text: 'Debug Menu'
                NextScreenButton:
                    id: NEXT_SCREEN_BUTTON
                    text: 'Next (Lightdream)'
                    on_press:
                        root.next_screen_callback(args[0])
            BoxLayout:
                id: mode_selection_buttons
                size_hint: 4, 1
                padding: 50
                spacing: 10
                orientation: 'horizontal'
                Button:
                    text: "Playlist Mode"
                    on_press: root.set_mode('playlist')
                Button:
                    text: "DJ / Autoplay Mode"
                    on_press: root.set_mode('autoplay')
                Button:
                    text: "Multiverse Setup (gods only)"
                    on_press: root.set_mode('metronome')
        FloatLayout:
            FloatLayout:
                id: playlist_controller
                BoxLayout:
                    orientation: 'horizontal'
                    GridLayout:
                        id: track_grid
                        size_hint: 2, 1
                        cols: 2
                        padding: 10
                        spacing: 10
                        size: 400, 400
                    GridLayout:
                        cols: 1
                        padding: 10
                        spacing: 10
                        Label:
                            text: "        Track Queue\npress to stop/remove"
                            size_hint_y: 0.05
                        GridLayout:
                            id: track_queue
                            cols: 1
                            spacing: 10
            FloatLayout:
                id: autoplay_controller
                BoxLayout:
                    orientation: 'horizontal'
                    GridLayout:
                        id: autoplay_options
                        cols: 1
                        padding: (250, 10, 250, 200)
                        spacing: 50
                        canvas.before:
                            Color:
                                rgba: hex('#000000')
                            Rectangle:
                                pos: self.pos
                                size: self.size

                        Label:
                            text: "Auto Controls"
                            size_hint_y: None
                            height: 200

                        BoxLayout:
                            orientation: 'horizontal'
                            size_hint_y: 0.15
                            padding: 30
                            Label:
                                text: "Autoclips clip length (in seconds)"
                            Label:
                                id: autoplay_interval_value
                        Slider:
                            id: autoplay_interval
                            min: 0
                            max: 60
                            step: 1
                            on_touch_up: root.update_config_value('autoplay_interval', self.value)

                        BoxLayout:
                            orientation: 'horizontal'
                            size_hint_y: 0.05
                            padding: 30
                            Label:
                                text: "Crossfade Interval (in seconds)"
                            Label:
                                id: autoplay_crossfade_value
                        Slider:
                            id: autoplay_crossfade
                            min: 0
                            max: 20
                            step: 0.5
                            on_touch_up: root.update_config_value('autoplay_crossfade', self.value)


                    GridLayout:
                        id: audio_responsiveness
                        cols: 1
                        padding: (250, 10, 250, 200)
                        spacing: 50

                        Label:
                            text: "Audio Responsiveness"
                            size_hint_y: 0.05

                        BoxLayout:
                            orientation: 'horizontal'
                            size_hint_y: 0.05
                            Label:
                                text: "Max Energy\n(not too much red plz)"
                            Label:
                                id: max_energy_value

                        BoxLayout:
                            id: energy_original_container
                            orientation: 'horizontal'
                            size_hint_y: 0.05
                            canvas.before:
                                Color: 
                                    rgba: 0,1,0,1
                                Rectangle:
                                    pos: 1360,740
                                    size: 200,20
                                Color: 
                                    rgba: 1,0,0,root.energy_orig_list[0]
                                Rectangle:
                                    pos: 1360,740
                                    size: 20,20
                                Color: 
                                    rgba: 1,0,0,root.energy_orig_list[1]
                                Rectangle:
                                    pos: 1360+20,740
                                    size: 20,20
                                Color: 
                                    rgba: 1,0,0,root.energy_orig_list[2]
                                Rectangle:
                                    pos: 1360+40,740
                                    size: 20,20
                                Color: 
                                    rgba: 1,0,0,root.energy_orig_list[3]
                                Rectangle:
                                    pos: 1360+60,740
                                    size: 20,20
                                Color: 
                                    rgba: 1,0,0,root.energy_orig_list[4]
                                Rectangle:
                                    pos: 1360+80,740
                                    size: 20,20
                                Color: 
                                    rgba: 1,0,0,root.energy_orig_list[5]
                                Rectangle:
                                    pos: 1360+100,740
                                    size: 20,20
                                Color: 
                                    rgba: 1,0,0,root.energy_orig_list[6]
                                Rectangle:
                                    pos: 1360+120,740
                                    size: 20,20
                                Color: 
                                    rgba: 1,0,0,root.energy_orig_list[7]
                                Rectangle:
                                    pos: 1360+140,740
                                    size: 20,20
                                Color: 
                                    rgba: 1,0,0,root.energy_orig_list[8]
                                Rectangle:
                                    pos: 1360+160,740
                                    size: 20,20
                                Color: 
                                    rgba: 1,0,0,root.energy_orig_list[9]
                                Rectangle:
                                    pos: 1360+180,740
                                    size: 20,20                                

                        Slider:
                            id: max_energy
                            min: 0.1
                            max: 100
                            step: 0.1
                            on_touch_up: root.update_config_value('max_energy', self.value)

                        BoxLayout:
                            orientation: 'horizontal'
                            size_hint_y: 0.05
                            Label:
                                text: "Decay Constant\nReally sharp decay (10% per frame) <--> Weak decay (1% per frame)"
                            Label:
                                id: decay_constant_value
                        
                        BoxLayout:
                            id: energy_modified_container
                            orientation: 'horizontal'
                            size_hint_y: 0.05
                            canvas.before:
                                Color: 
                                    rgba: 0,1,0,1
                                Rectangle:
                                    pos: 1360,470
                                    size: 200,20
                                Color: 
                                    rgba: 1,0,0,root.energy_mod_list[0]
                                Rectangle:
                                    pos: 1360,470
                                    size: 20,20
                                Color: 
                                    rgba: 1,0,0,root.energy_mod_list[1]
                                Rectangle:
                                    pos: 1360+20,470
                                    size: 20,20
                                Color: 
                                    rgba: 1,0,0,root.energy_mod_list[2]
                                Rectangle:
                                    pos: 1360+40,470
                                    size: 20,20
                                Color: 
                                    rgba: 1,0,0,root.energy_mod_list[3]
                                Rectangle:
                                    pos: 1360+60,470
                                    size: 20,20
                                Color: 
                                    rgba: 1,0,0,root.energy_mod_list[4]
                                Rectangle:
                                    pos: 1360+80,470
                                    size: 20,20
                                Color: 
                                    rgba: 1,0,0,root.energy_mod_list[5]
                                Rectangle:
                                    pos: 1360+100,470
                                    size: 20,20
                                Color: 
                                    rgba: 1,0,0,root.energy_mod_list[6]
                                Rectangle:
                                    pos: 1360+120,470
                                    size: 20,20
                                Color: 
                                    rgba: 1,0,0,root.energy_mod_list[7]
                                Rectangle:
                                    pos: 1360+140,470
                                    size: 20,20
                                Color: 
                                    rgba: 1,0,0,root.energy_mod_list[8]
                                Rectangle:
                                    pos: 1360+160,470
                                    size: 20,20
                                Color: 
                                    rgba: 1,0,0,root.energy_mod_list[9]
                                Rectangle:
                                    pos: 1360+180,470
                                    size: 20,20

                        Slider:
                            id: decay_constant
                            min: -0.1
                            max: -0.01
                            step: 0.001
                            on_touch_up: root.update_config_value('decay_constant', self.value)


                        BoxLayout:
                            orientation: 'horizontal'
                            size_hint_y: 0.05
                            Label:
                                text: "Aural Effect Strength Multiplier"
                            Label:
                                id: aural_effect_strength_multiplier_value
                        Slider:
                            id: aural_effect_strength_multiplier
                            min: 0
                            max: 1
                            step: 0.01
                            on_touch_up: root.update_config_value('aural_effect_strength_multiplier', self.value)
            FloatLayout:
                id: metronome_controller
                canvas.before:
                    Color:
                        rgba: hex('#222222')
                    Rectangle:
                        pos: self.pos
                        size: self.size
                BoxLayout:
                    orientation: 'horizontal'
                    GridLayout:
                        id: metronome_options
                        cols: 1
                        padding: 10
                        spacing: 10
                        canvas.before:
                            Color:
                                rgba: hex('#226622')
                            Rectangle:
                                pos: self.pos
                                size: self.size
                        BoxLayout:
                            orientation: 'horizontal'
                            size_hint_y: 0.05
                            Label:
                                text: "Brain Position\n0-4 normal cycle, 5-9 reversed"
                            Label:
                                id: brain_position_value
                        Slider:
                            id: brain_position
                            min: 0
                            max: 9
                            step: 1
                            on_touch_up: root.update_config_value('brain_position', int(self.value))





<LayoutTestScreen>:
    name: "layout_test"
    canvas.before:
        Rectangle:
            pos: self.pos
            size: self.size
            source: "images/!touchscreen layout 4.png"
    ThisScreenLabel:
        text: 'Layout Test'
    NextScreenButton:
        id: NEXT_SCREEN_BUTTON
        text: 'Next (Debug)'